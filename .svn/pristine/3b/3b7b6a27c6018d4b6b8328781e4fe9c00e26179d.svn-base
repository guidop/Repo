#include "CNGConfigFunctionTest.h"
#include "..\..\CNG\CNG.h"
#include "..\..\CNG\Timer.h"
#include <bitset>

using namespace std;
CNGConfigFunctionTest::CNGConfigFunctionTest(void)
{
}


CNGConfigFunctionTest::~CNGConfigFunctionTest(void)
{
}


TEST(CNGConfigFunctionTest, CheckFipsIsEnabled) 
{
	CNG cng;
	ASSERT_EQ(cng.CheckIfFipsIsEnabled(),0);
}

TEST(CNGConfigFunctionTest, EnumCryptoProvider) 
{
	CNG cng;
	BCRYPT_PROVIDER_NAME *ppImplList;
	ULONG pImplCount;
	wstring ws(L"SHA1" );

	LPCWSTR pszAlgId = ws.c_str();
	cng.EnumCrypyProvider(pszAlgId, &ppImplList, pImplCount);

	for(int i=0; i < (int)pImplCount;i++)
	{
		//std::copy(ws.begin(),ws.end(),std::ostream_iterator<wchar_t>( std::cout, ", " ) );
		
		//cout << "provider per " << ws.c_str() << " è " << ppImplList[i].pszProviderName << endl;
	}
	
}

TEST(CNGConfigFunctionTest, TestPerformance) 
{
	CTimer timer;
	ostringstream pippo;
	


	int iteration = 100000;

	timer.Start();
	for(int i=0; i< iteration; i++)
	{
		double val1 = i*2.3;
		double val2 = i*4.7;
		double val3 = i*5.378;
		pippo << val1 << "|" << val2 << "|" << val3 << endl;
	}
	timer.Stop();

	char buffer1[100];
	char buffer2[100];
	char buffer3[100];
	timer.Start();
	for(int i=0; i< iteration; i++)
	{
		double val1 = i*2.3;
		double val2 = i*4.7;
		double val3 = i*5.378;
		sprintf_s(buffer1,"%g",val1);
		sprintf_s(buffer2,"%g",val2);
		sprintf_s(buffer3,"%g",val3);
	}
	timer.Stop();

	
}

