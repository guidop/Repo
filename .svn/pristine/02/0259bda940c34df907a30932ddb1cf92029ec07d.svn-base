#include "HashingTest.h"
#include <windows.h>
#include <iostream>
#include "..\..\CNG\CryptHashingOperation.h"

using namespace std;

CHashingTest::CHashingTest(void)
{
}


CHashingTest::~CHashingTest(void)
{
}

TEST(CHashingTest, CalculateHash) 
{

	BYTE rgbMsg[] = {'a', 'b', 'b'};
	PUCHAR resultHash;
	CCryptHashingOperation cryptHashOperation;
	resultHash =  cryptHashOperation.CreateHash(rgbMsg);

	wstring resultHashToString = cryptHashOperation.ConvertHashDigestToString(resultHash,16);
	/*string result;
	result.assign((char*)resultHash, 16);
	int val=0;
	for (int i=0;i<(int)result.size(); i++)
	{
		val = result[i];
		printf("0%d\n",val);
	}*/
	
	if(resultHash)
	{
		HeapFree(GetProcessHeap(), 0, resultHash);

	}
}