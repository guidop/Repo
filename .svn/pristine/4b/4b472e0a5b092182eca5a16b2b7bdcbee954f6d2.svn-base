#include "CNGConfigFunctionTest.h"
#include "..\..\CNG\CNG.h"
#include <bitset>

using namespace std;
CNGConfigFunctionTest::CNGConfigFunctionTest(void)
{
}


CNGConfigFunctionTest::~CNGConfigFunctionTest(void)
{
}


TEST(CNGConfigFunctionTest, CheckFipsIsEnabled) 
{
	CNG cng;
	ASSERT_EQ(cng.CheckIfFipsIsEnabled(),0);
}

TEST(CNGConfigFunctionTest, EnumCryptoProvider) 
{
	CNG cng;
	BCRYPT_PROVIDER_NAME *ppImplList;
	ULONG pImplCount;
	wstring ws(L"SHA1" );

	LPCWSTR pszAlgId = ws.c_str();
	cng.EnumCrypyProvider(pszAlgId, &ppImplList, pImplCount);

	for(int i=0; i < (int)pImplCount;i++)
	{
		//std::copy(ws.begin(),ws.end(),std::ostream_iterator<wchar_t>( std::cout, ", " ) );
		
		//cout << "provider per " << ws.c_str() << " è " << ppImplList[i].pszProviderName << endl;
	}
	
}