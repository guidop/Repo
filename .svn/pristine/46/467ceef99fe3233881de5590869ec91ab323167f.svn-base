#include "HashingTest.h"
#include <windows.h>
#include <iostream>
#include "..\..\CNG\CryptHashingOperation.h"

using namespace std;

CHashingTest::CHashingTest(void)
{
}


CHashingTest::~CHashingTest(void)
{
}

TEST(CHashingTest, CalculateHash) 
{

	
	wstring rgbMsg(L"abb");
	PUCHAR resultHash;
	CCryptHashingOperation cryptHashOperation;
	resultHash =  cryptHashOperation.CreateHash(rgbMsg);

	wstring resultHashToString = cryptHashOperation.ConvertHashDigestToString(resultHash,16);
	
	if(resultHash)
	{
		HeapFree(GetProcessHeap(), 0, resultHash);
	}

	ASSERT_EQ(resultHashToString,L"ea01e5fd8e4d8832825acdd20eac5104");
}